<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.neefull.fsp.web.system.mapper.AuthCorpMapper">

    <!-- 根据用户id获取企业用户认证信息 -->
    <select id="findByUserId" parameterType="Long" resultType="com.neefull.fsp.web.system.entity.AuthCorp">
        select *,case when auth_status = '0' then '认证失败' when auth_status = '1' then '认证通过' else '' END authStatusName,
        case when auth_type = '1' then '自动' when auth_type = '2' then '人工' else '' END authTypeName,
        DATE_FORMAT(authpass_time,'%Y-%d-%m %T') authpassTimeStr from t_auth_corp where user_id = #{userId}
    </select>

    <!-- 更新企业用户表信息 -->
    <update id="updateAuthCorpByUserId" parameterType="com.neefull.fsp.web.system.entity.AuthCorp">
      update t_auth_corp set
        <if test="legalName != null and legalName != ''">
            legal_name = #{legalName},
        </if>
        <if test="corpName != null and corpName != ''">
            corp_name = #{corpName},
        </if>
        <if test="creditCode != null and creditCode != ''">
            credit_code = #{creditCode},
        </if>
        <if test="bankNo != null and bankNo != ''">
            bank_no = #{bankNo},
        </if>
        <if test="bankName != null and bankName != ''">
            bank_name = #{bankName},
        </if>
        <if test="corpAddress != null and corpAddress != ''">
            corp_address = #{corpAddress},
        </if>
        <if test="linkNo != null and linkNo != ''">
            link_no = #{linkNo},
        </if>
        <if test="businessLience != null and businessLience != ''">
            business_lience = #{businessLience},
        </if>
        <if test="openLience != null and openLience != ''">
            open_lience = #{openLience},
        </if>
        <if test="authStatus != null and authStatus != ''">
            auth_status = #{authStatus},
        </if>
        <if test="authType != null and authType != ''">
            auth_type = #{authType},
        </if>
        <if test="authpassTime != null">
            authpass_time = NOW(),
        </if>
        <if test="authpassUser != null and authpassUser != ''">
            authpass_user = #{authpassUser},
        </if>
        <if test="remark != null and remark != ''">
            remark = #{remark},
        </if>
        modify_time = NOW()
      where user_id = #{userId}
    </update>
</mapper>
